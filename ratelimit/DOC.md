# grpc_ratelimit
`import "github.com/grpc-ecosystem/go-grpc-middleware/ratelimit"`

* [Overview](#pkg-overview)
* [Imported Packages](#pkg-imports)
* [Index](#pkg-index)
* [Examples](#pkg-examples)

## <a name="pkg-overview">Overview</a>
`grpc_ratelimit` a generic server-side ratelimit middleware for gRPC.

### Server Side Ratelimit Middleware
It allows to use your own rate limiter (e.g. token bucket, leaky bucket, etc.) to do grpc rate limit.

`ratelimit/tokenbucket`provides an implementation based on  token bucket `github.com/juju/ratelimit`.

Please see examples for simple examples of use.

#### Example:

<details>
<summary>Click to expand code.</summary>

```go
// Create unary/stream rateLimiters, based on token bucket here.
// You can implement your own ratelimiter for the interface.
unaryRateLimiter := tokenbucket.NewTokenBucketRateLimiter(1*time.Second, 10, 10)
streamRateLimiter := tokenbucket.NewTokenBucketRateLimiter(1*time.Second, 5, 5)
_ = grpc.NewServer(
    grpc_middleware.WithUnaryServerChain(
        grpc_ratelimit.UnaryServerInterceptor(
            grpc_ratelimit.WithLimiter(unaryRateLimiter),
            grpc_ratelimit.WithMaxWaitDuration(10*time.Second),
        ),
    ),
    grpc_middleware.WithStreamServerChain(
        grpc_ratelimit.StreamServerInterceptor(
            grpc_ratelimit.WithLimiter(streamRateLimiter),
            grpc_ratelimit.WithMaxWaitDuration(5*time.Second),
        ),
    ),
)
```

</details>

## <a name="pkg-imports">Imported Packages</a>

- [golang.org/x/net/context](https://godoc.org/golang.org/x/net/context)
- [google.golang.org/grpc](https://godoc.org/google.golang.org/grpc)
- [google.golang.org/grpc/codes](https://godoc.org/google.golang.org/grpc/codes)
- [google.golang.org/grpc/status](https://godoc.org/google.golang.org/grpc/status)

## <a name="pkg-index">Index</a>
* [func StreamServerInterceptor(opts ...Option) grpc.StreamServerInterceptor](#StreamServerInterceptor)
* [func UnaryServerInterceptor(opts ...Option) grpc.UnaryServerInterceptor](#UnaryServerInterceptor)
* [type Limiter](#Limiter)
* [type Option](#Option)
  * [func WithLimiter(l Limiter) Option](#WithLimiter)
  * [func WithMaxWaitDuration(maxWaitDuration time.Duration) Option](#WithMaxWaitDuration)

#### <a name="pkg-examples">Examples</a>
* [Package (Initialization)](#example__initialization)

#### <a name="pkg-files">Package files</a>
[doc.go](./doc.go) [options.go](./options.go) [ratelimit.go](./ratelimit.go) 

## <a name="StreamServerInterceptor">func</a> [StreamServerInterceptor](./ratelimit.go#L55)
``` go
func StreamServerInterceptor(opts ...Option) grpc.StreamServerInterceptor
```
StreamServerInterceptor returns a new stream server interceptors that performs request rate limit.

## <a name="UnaryServerInterceptor">func</a> [UnaryServerInterceptor](./ratelimit.go#L41)
``` go
func UnaryServerInterceptor(opts ...Option) grpc.UnaryServerInterceptor
```
UnaryServerInterceptor returns a new unary server interceptors that performs request rate limit.

## <a name="Limiter">type</a> [Limiter](./ratelimit.go#L15-L17)
``` go
type Limiter interface {
    WaitMaxDuration(time.Duration) bool
}
```

## <a name="Option">type</a> [Option](./options.go#L10)
``` go
type Option func(*rateLimiter)
```

### <a name="WithLimiter">func</a> [WithLimiter](./options.go#L13)
``` go
func WithLimiter(l Limiter) Option
```
WithLimiter customizes your limiter in the middleware

### <a name="WithMaxWaitDuration">func</a> [WithMaxWaitDuration](./options.go#L23)
``` go
func WithMaxWaitDuration(maxWaitDuration time.Duration) Option
```
WithMaxWaitDuration customizes maxWaitDuration in limiter's WaitMaxDuration action.

- - -
Generated by [godoc2ghmd](https://github.com/GandalfUK/godoc2ghmd)